"use strict";




const path = require('path');
const assert = require('assert');
const resolve = require('resolve');
const slash = require('slash');
const moduleRootPath = `${__dirname}/../../../`;
const { runscriptManagerInContainerWithClientApp } = require(moduleRootPath);
const { parseKeyValuePairSeparatedBySymbolFromArray, combineKeyValueObjectIntoString } = require('@dependency/parseKeyValuePairSeparatedBySymbol');
const ownConfig = require(path.join(moduleRootPath, 'configuration/configuration.js'));
const { configurationFileLookup } = require(`@dependency/configurationManagement`);

const message_prefix = `\x1b[3m\x1b[2m•[${path.basename(__filename)} JS script]:\x1b[0m`;
console.group(`%s \x1b[33m%s\x1b[0m`, `${message_prefix}`, `ƒ container manager - container with volumes & requested entrypoint script`);

cliInterface();






function cliInterface() {

  const currentDirectory = path.normalize(process.cwd()),
  namedArgs = parseKeyValuePairSeparatedBySymbolFromArray({ array: process.argv }),
  scriptPath = path.normalize(process.argv[1]);

  let { configuration: applicationConfig, path: configurationPath } = configurationFileLookup({
    configurationPath: namedArgs.configuration,
    currentDirectory,
    configurationBasePath: ownConfig.targetApp.configurationBasePath });



  let relativeScriptFromPWDPath = path.relative(currentDirectory, scriptPath),
  nodeModulesPartialPath = ['node_modules'].concat(relativeScriptFromPWDPath.split('node_modules').slice(1)).join(''),
  nodeModulesParentPartialPath = relativeScriptFromPWDPath.split('node_modules').shift(),
  nodeModulesParentPath = path.join(currentDirectory, nodeModulesParentPartialPath);

  const scriptManagerHostRelativePath = path.dirname(resolve.sync('@dependency/appDeploymentManager/package.json', { preserveSymlinks: true, basedir: nodeModulesParentPath }));


  console.log(`Project root path: ${applicationConfig.directory.application.hostAbsolutePath}`);
  runscriptManagerInContainerWithClientApp({
    configurationAbsoluteHostPath: configurationPath,
    application: {
      hostPath: applicationConfig.directory.application.hostAbsolutePath,
      configuration: applicationConfig },

    scriptManager: {
      hostRelativePath: scriptManagerHostRelativePath },

    invokedDirectly: require.main === module ? true : false });

}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NvdXJjZS9ydW5JbkNvbnRhaW5lci9jbGllbnRJbnRlcmZhY2UvY29tbWFuZExpbmUuanMiXSwibmFtZXMiOlsicGF0aCIsInJlcXVpcmUiLCJhc3NlcnQiLCJyZXNvbHZlIiwic2xhc2giLCJtb2R1bGVSb290UGF0aCIsIl9fZGlybmFtZSIsInJ1bnNjcmlwdE1hbmFnZXJJbkNvbnRhaW5lcldpdGhDbGllbnRBcHAiLCJwYXJzZUtleVZhbHVlUGFpclNlcGFyYXRlZEJ5U3ltYm9sRnJvbUFycmF5IiwiY29tYmluZUtleVZhbHVlT2JqZWN0SW50b1N0cmluZyIsIm93bkNvbmZpZyIsImpvaW4iLCJjb25maWd1cmF0aW9uRmlsZUxvb2t1cCIsIm1lc3NhZ2VfcHJlZml4IiwiYmFzZW5hbWUiLCJfX2ZpbGVuYW1lIiwiY29uc29sZSIsImdyb3VwIiwiY2xpSW50ZXJmYWNlIiwiY3VycmVudERpcmVjdG9yeSIsIm5vcm1hbGl6ZSIsInByb2Nlc3MiLCJjd2QiLCJuYW1lZEFyZ3MiLCJhcnJheSIsImFyZ3YiLCJzY3JpcHRQYXRoIiwiY29uZmlndXJhdGlvbiIsImFwcGxpY2F0aW9uQ29uZmlnIiwiY29uZmlndXJhdGlvblBhdGgiLCJjb25maWd1cmF0aW9uQmFzZVBhdGgiLCJ0YXJnZXRBcHAiLCJyZWxhdGl2ZVNjcmlwdEZyb21QV0RQYXRoIiwicmVsYXRpdmUiLCJub2RlTW9kdWxlc1BhcnRpYWxQYXRoIiwiY29uY2F0Iiwic3BsaXQiLCJzbGljZSIsIm5vZGVNb2R1bGVzUGFyZW50UGFydGlhbFBhdGgiLCJzaGlmdCIsIm5vZGVNb2R1bGVzUGFyZW50UGF0aCIsInNjcmlwdE1hbmFnZXJIb3N0UmVsYXRpdmVQYXRoIiwiZGlybmFtZSIsInN5bmMiLCJwcmVzZXJ2ZVN5bWxpbmtzIiwiYmFzZWRpciIsImxvZyIsImRpcmVjdG9yeSIsImFwcGxpY2F0aW9uIiwiaG9zdEFic29sdXRlUGF0aCIsImNvbmZpZ3VyYXRpb25BYnNvbHV0ZUhvc3RQYXRoIiwiaG9zdFBhdGgiLCJzY3JpcHRNYW5hZ2VyIiwiaG9zdFJlbGF0aXZlUGF0aCIsImludm9rZWREaXJlY3RseSIsIm1haW4iLCJtb2R1bGUiXSwibWFwcGluZ3MiOiI7Ozs7O0FBS0EsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsTUFBRCxDQUFwQjtBQUNBLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLFFBQUQsQ0FBdEI7QUFDQSxNQUFNRSxPQUFPLEdBQUdGLE9BQU8sQ0FBQyxTQUFELENBQXZCO0FBQ0EsTUFBTUcsS0FBSyxHQUFHSCxPQUFPLENBQUMsT0FBRCxDQUFyQjtBQUNBLE1BQU1JLGNBQWMsR0FBSSxHQUFFQyxTQUFVLFlBQXBDO0FBQ0EsTUFBTSxFQUFFQyx3Q0FBRixLQUErQ04sT0FBTyxDQUFDSSxjQUFELENBQTVEO0FBQ0EsTUFBTSxFQUFFRywyQ0FBRixFQUErQ0MsK0JBQS9DLEtBQW1GUixPQUFPLENBQUMsZ0RBQUQsQ0FBaEc7QUFDQSxNQUFNUyxTQUFTLEdBQUdULE9BQU8sQ0FBQ0QsSUFBSSxDQUFDVyxJQUFMLENBQVVOLGNBQVYsRUFBMEIsZ0NBQTFCLENBQUQsQ0FBekI7QUFDQSxNQUFNLEVBQUVPLHVCQUFGLEtBQThCWCxPQUFPLENBQUUscUNBQUYsQ0FBM0M7O0FBRUEsTUFBTVksY0FBYyxHQUFJLG1CQUFrQmIsSUFBSSxDQUFDYyxRQUFMLENBQWNDLFVBQWQsQ0FBMEIscUJBQXBFO0FBQ0FDLE9BQU8sQ0FBQ0MsS0FBUixDQUFlLHNCQUFmLEVBQXVDLEdBQUVKLGNBQWUsRUFBeEQsRUFBNEQsNEVBQTVEOztBQUVBSyxZQUFZOzs7Ozs7O0FBT1osU0FBU0EsWUFBVCxHQUF3Qjs7QUFFdEIsUUFBTUMsZ0JBQWdCLEdBQUduQixJQUFJLENBQUNvQixTQUFMLENBQWVDLE9BQU8sQ0FBQ0MsR0FBUixFQUFmLENBQXpCO0FBQ0VDLEVBQUFBLFNBQVMsR0FBR2YsMkNBQTJDLENBQUMsRUFBRWdCLEtBQUssRUFBRUgsT0FBTyxDQUFDSSxJQUFqQixFQUFELENBRHpEO0FBRUVDLEVBQUFBLFVBQVUsR0FBRzFCLElBQUksQ0FBQ29CLFNBQUwsQ0FBZUMsT0FBTyxDQUFDSSxJQUFSLENBQWEsQ0FBYixDQUFmLENBRmY7O0FBSUEsTUFBSSxFQUFFRSxhQUFhLEVBQUVDLGlCQUFqQixFQUFvQzVCLElBQUksRUFBRTZCLGlCQUExQyxLQUFnRWpCLHVCQUF1QixDQUFDO0FBQzFGaUIsSUFBQUEsaUJBQWlCLEVBQUVOLFNBQVMsQ0FBQ0ksYUFENkQ7QUFFMUZSLElBQUFBLGdCQUYwRjtBQUcxRlcsSUFBQUEscUJBQXFCLEVBQUVwQixTQUFTLENBQUNxQixTQUFWLENBQW9CRCxxQkFIK0MsRUFBRCxDQUEzRjs7OztBQU9BLE1BQUlFLHlCQUF5QixHQUFHaEMsSUFBSSxDQUFDaUMsUUFBTCxDQUFjZCxnQkFBZCxFQUFnQ08sVUFBaEMsQ0FBaEM7QUFDRVEsRUFBQUEsc0JBQXNCLEdBQUcsQ0FBQyxjQUFELEVBQWlCQyxNQUFqQixDQUF3QkgseUJBQXlCLENBQUNJLEtBQTFCLENBQWdDLGNBQWhDLEVBQWdEQyxLQUFoRCxDQUFzRCxDQUF0RCxDQUF4QixFQUFrRjFCLElBQWxGLENBQXVGLEVBQXZGLENBRDNCO0FBRUUyQixFQUFBQSw0QkFBNEIsR0FBR04seUJBQXlCLENBQUNJLEtBQTFCLENBQWdDLGNBQWhDLEVBQWdERyxLQUFoRCxFQUZqQztBQUdFQyxFQUFBQSxxQkFBcUIsR0FBR3hDLElBQUksQ0FBQ1csSUFBTCxDQUFVUSxnQkFBVixFQUE0Qm1CLDRCQUE1QixDQUgxQjs7QUFLQSxRQUFNRyw2QkFBNkIsR0FBR3pDLElBQUksQ0FBQzBDLE9BQUwsQ0FBYXZDLE9BQU8sQ0FBQ3dDLElBQVIsQ0FBYSwrQ0FBYixFQUE4RCxFQUFFQyxnQkFBZ0IsRUFBRSxJQUFwQixFQUEwQkMsT0FBTyxFQUFFTCxxQkFBbkMsRUFBOUQsQ0FBYixDQUF0Qzs7O0FBR0F4QixFQUFBQSxPQUFPLENBQUM4QixHQUFSLENBQWEsc0JBQXFCbEIsaUJBQWlCLENBQUNtQixTQUFsQixDQUE0QkMsV0FBNUIsQ0FBd0NDLGdCQUFpQixFQUEzRjtBQUNBMUMsRUFBQUEsd0NBQXdDLENBQUM7QUFDdkMyQyxJQUFBQSw2QkFBNkIsRUFBRXJCLGlCQURRO0FBRXZDbUIsSUFBQUEsV0FBVyxFQUFFO0FBQ1hHLE1BQUFBLFFBQVEsRUFBRXZCLGlCQUFpQixDQUFDbUIsU0FBbEIsQ0FBNEJDLFdBQTVCLENBQXdDQyxnQkFEdkM7QUFFWHRCLE1BQUFBLGFBQWEsRUFBRUMsaUJBRkosRUFGMEI7O0FBTXZDd0IsSUFBQUEsYUFBYSxFQUFFO0FBQ2JDLE1BQUFBLGdCQUFnQixFQUFFWiw2QkFETCxFQU53Qjs7QUFTdkNhLElBQUFBLGVBQWUsRUFBRXJELE9BQU8sQ0FBQ3NELElBQVIsS0FBaUJDLE1BQWpCLEdBQTBCLElBQTFCLEdBQWlDLEtBVFgsRUFBRCxDQUF4Qzs7QUFXRCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogIHJ1biBjb250YWluZXIgbWFuYWdlciB3aXRoIHJlcXVlc3RlZCBjb21tYW5kLlxuICogIC4vc2V0dXAvbm9kZV9tb2R1bGVzLy5iaW4vY29udGFpbmVyTWFuYWdlciBjb25maWd1cmF0aW9uPS4vc2V0dXAvY29uZmlndXJhdGlvbi9jb25maWd1cmF0aW9uLmpzIGVudHJ5cG9pbnRDb25maWd1cmF0aW9uS2V5PXRlc3RcbiAqICovXG5cbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJylcbmNvbnN0IGFzc2VydCA9IHJlcXVpcmUoJ2Fzc2VydCcpXG5jb25zdCByZXNvbHZlID0gcmVxdWlyZSgncmVzb2x2ZScpXG5jb25zdCBzbGFzaCA9IHJlcXVpcmUoJ3NsYXNoJykgLy8gY29udmVydCBiYWNrd2FyZCBXaW5kb3dzIHNsYXNoIHRvIFVuaXgvV2luZG93cyBzdXBwb3J0ZWQgZm9yd2FyZCBzbGFzaC5cbmNvbnN0IG1vZHVsZVJvb3RQYXRoID0gYCR7X19kaXJuYW1lfS8uLi8uLi8uLi9gXG5jb25zdCB7IHJ1bnNjcmlwdE1hbmFnZXJJbkNvbnRhaW5lcldpdGhDbGllbnRBcHAgfSA9IHJlcXVpcmUobW9kdWxlUm9vdFBhdGgpXG5jb25zdCB7IHBhcnNlS2V5VmFsdWVQYWlyU2VwYXJhdGVkQnlTeW1ib2xGcm9tQXJyYXksIGNvbWJpbmVLZXlWYWx1ZU9iamVjdEludG9TdHJpbmcgfSA9IHJlcXVpcmUoJ0BkZXBlbmRlbmN5L3BhcnNlS2V5VmFsdWVQYWlyU2VwYXJhdGVkQnlTeW1ib2wnKVxuY29uc3Qgb3duQ29uZmlnID0gcmVxdWlyZShwYXRoLmpvaW4obW9kdWxlUm9vdFBhdGgsICdjb25maWd1cmF0aW9uL2NvbmZpZ3VyYXRpb24uanMnKSkgLy8gY29udGFpbmVyIG1hbmFnZXIgY29uZmlnIHBhdGhcbmNvbnN0IHsgY29uZmlndXJhdGlvbkZpbGVMb29rdXAgfSA9IHJlcXVpcmUoYEBkZXBlbmRlbmN5L2NvbmZpZ3VyYXRpb25NYW5hZ2VtZW50YClcblxuY29uc3QgbWVzc2FnZV9wcmVmaXggPSBgXFx4MWJbM21cXHgxYlsybeKAolske3BhdGguYmFzZW5hbWUoX19maWxlbmFtZSl9IEpTIHNjcmlwdF06XFx4MWJbMG1gXG5jb25zb2xlLmdyb3VwKGAlcyBcXHgxYlszM20lc1xceDFiWzBtYCwgYCR7bWVzc2FnZV9wcmVmaXh9YCwgYMaSIGNvbnRhaW5lciBtYW5hZ2VyIC0gY29udGFpbmVyIHdpdGggdm9sdW1lcyAmIHJlcXVlc3RlZCBlbnRyeXBvaW50IHNjcmlwdGApXG5cbmNsaUludGVyZmFjZSgpXG5cbi8qKlxuICogVVNBR0U6XG4gKiAgc2NyaXB0IGludm9rYXRpb24gZnJvbSBzaGVsbCB1c2luZzogbnB4IHx8IHlhcm4gcnVuIHx8IDxwYXRoVG9TY3JpcHQ+IChlLmcuIC4vc2V0dXAvbm9kZV9tb2R1bGVzLy5iaW4vY29udGFpbmVyTWFuYWdlci5qcylcbiAqICBTaGVsbDogeWFybiBydW4gY2xpQWRhcHRlciBjb25maWd1cmF0aW9uPTxyZWxhdGl2ZVBhdGhUb0NvbmZpZ3VyYXRpb25Gcm9tUFdEPiA8ZmlsZW5hbWU+XG4gKi9cbmZ1bmN0aW9uIGNsaUludGVyZmFjZSgpIHtcbiAgLyoqIFBhcnNlIGFyZ3VtZW50cyBhbmQgaW5pdGlhbGl6ZSBwYXJhbWV0ZXJzICovXG4gIGNvbnN0IGN1cnJlbnREaXJlY3RvcnkgPSBwYXRoLm5vcm1hbGl6ZShwcm9jZXNzLmN3ZCgpKSwgLy8gZ2V0IGN1cnJlbnQgZGlyZWN0b3J5XG4gICAgbmFtZWRBcmdzID0gcGFyc2VLZXlWYWx1ZVBhaXJTZXBhcmF0ZWRCeVN5bWJvbEZyb21BcnJheSh7IGFycmF5OiBwcm9jZXNzLmFyZ3YgfSksIC8vIFsneD15J10gLS0+IHsgeDogeSB9XG4gICAgc2NyaXB0UGF0aCA9IHBhdGgubm9ybWFsaXplKHByb2Nlc3MuYXJndlsxXSkgLy8gdGhlIHNjcmlwdCB0aGF0IHNob3VsZCBiZSBleGVjdXRlZCBvbiB0aGUgdGFyZ2V0IGFwcGxpY2F0aW9uLlxuXG4gIGxldCB7IGNvbmZpZ3VyYXRpb246IGFwcGxpY2F0aW9uQ29uZmlnLCBwYXRoOiBjb25maWd1cmF0aW9uUGF0aCB9ID0gY29uZmlndXJhdGlvbkZpbGVMb29rdXAoe1xuICAgIGNvbmZpZ3VyYXRpb25QYXRoOiBuYW1lZEFyZ3MuY29uZmlndXJhdGlvbixcbiAgICBjdXJyZW50RGlyZWN0b3J5LFxuICAgIGNvbmZpZ3VyYXRpb25CYXNlUGF0aDogb3duQ29uZmlnLnRhcmdldEFwcC5jb25maWd1cmF0aW9uQmFzZVBhdGgsXG4gIH0pXG5cbiAgLy8gZ2V0IHN5bWxpbmsgcGF0aFxuICBsZXQgcmVsYXRpdmVTY3JpcHRGcm9tUFdEUGF0aCA9IHBhdGgucmVsYXRpdmUoY3VycmVudERpcmVjdG9yeSwgc2NyaXB0UGF0aCksXG4gICAgbm9kZU1vZHVsZXNQYXJ0aWFsUGF0aCA9IFsnbm9kZV9tb2R1bGVzJ10uY29uY2F0KHJlbGF0aXZlU2NyaXB0RnJvbVBXRFBhdGguc3BsaXQoJ25vZGVfbW9kdWxlcycpLnNsaWNlKDEpKS5qb2luKCcnKSwgLy8gZ2V0IHBhdGggZWxlbWVudHMgYWZ0ZXIgZmlyc3Qgbm9kZV9tb2R1bGVzIGFwcGVhcmFuY2UgaS5lLiAveC9ub2RlX21vZHVsZXMveSAtLT4gbm9kZV9tb2R1bGVzL3lcbiAgICBub2RlTW9kdWxlc1BhcmVudFBhcnRpYWxQYXRoID0gcmVsYXRpdmVTY3JpcHRGcm9tUFdEUGF0aC5zcGxpdCgnbm9kZV9tb2R1bGVzJykuc2hpZnQoKSwgLy8gL3gvbm9kZV9tb2R1bGVzL3kgLS0+IC94L1xuICAgIG5vZGVNb2R1bGVzUGFyZW50UGF0aCA9IHBhdGguam9pbihjdXJyZW50RGlyZWN0b3J5LCBub2RlTW9kdWxlc1BhcmVudFBhcnRpYWxQYXRoKVxuXG4gIGNvbnN0IHNjcmlwdE1hbmFnZXJIb3N0UmVsYXRpdmVQYXRoID0gcGF0aC5kaXJuYW1lKHJlc29sdmUuc3luYygnQGRlcGVuZGVuY3kvYXBwRGVwbG95bWVudE1hbmFnZXIvcGFja2FnZS5qc29uJywgeyBwcmVzZXJ2ZVN5bWxpbmtzOiB0cnVlLCBiYXNlZGlyOiBub2RlTW9kdWxlc1BhcmVudFBhdGggfSkpIC8vIHVzZSAncmVzb2x2ZScgbW9kdWxlIHRvIGFsbG93IHBhc3NpbmcgJ3ByZXNlcnZlIHN5bWxpbmtzJyBvcHRpb24gdGhhdCBpcyBub3Qgc3VwcG9ydGVkIGJ5IHJlcXVpcmUucmVzb2x2ZSBtb2R1bGUuXG5cbiAgLyoqIGludm9rZSB0aGUgaGVscGVyIGZvciBzY3JpcHQgZXhlY3V0aW9uIGluIGNvbnRhaW5lciAgKi9cbiAgY29uc29sZS5sb2coYFByb2plY3Qgcm9vdCBwYXRoOiAke2FwcGxpY2F0aW9uQ29uZmlnLmRpcmVjdG9yeS5hcHBsaWNhdGlvbi5ob3N0QWJzb2x1dGVQYXRofWApXG4gIHJ1bnNjcmlwdE1hbmFnZXJJbkNvbnRhaW5lcldpdGhDbGllbnRBcHAoe1xuICAgIGNvbmZpZ3VyYXRpb25BYnNvbHV0ZUhvc3RQYXRoOiBjb25maWd1cmF0aW9uUGF0aCxcbiAgICBhcHBsaWNhdGlvbjoge1xuICAgICAgaG9zdFBhdGg6IGFwcGxpY2F0aW9uQ29uZmlnLmRpcmVjdG9yeS5hcHBsaWNhdGlvbi5ob3N0QWJzb2x1dGVQYXRoLFxuICAgICAgY29uZmlndXJhdGlvbjogYXBwbGljYXRpb25Db25maWcsXG4gICAgfSxcbiAgICBzY3JpcHRNYW5hZ2VyOiB7XG4gICAgICBob3N0UmVsYXRpdmVQYXRoOiBzY3JpcHRNYW5hZ2VySG9zdFJlbGF0aXZlUGF0aCxcbiAgICB9LFxuICAgIGludm9rZWREaXJlY3RseTogcmVxdWlyZS5tYWluID09PSBtb2R1bGUgPyB0cnVlIDogZmFsc2UsXG4gIH0pXG59XG4iXX0=