"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _path = _interopRequireDefault(require("path"));
var _slash = _interopRequireDefault(require("slash"));

const parsedArg = require('yargs').argv;

const containerPath = {

  application: '/project/application' };


parsedArg.env = !Array.isArray(parsedArg.env) ? [parsedArg.env] : parsedArg.env;
let exportEnvironmentArg = parsedArg.env.reduce((accumulator, currentValue) => {
  if (process.env[currentValue])

    accumulator[currentValue] = process.env[currentValue];
  return accumulator;
}, {});










module.exports = function runInContainer(input) {
  console.log(process.argv);

  let application = {},
  scriptManager = {},
  invokedDirectly,
  configurationAbsoluteHostPath;
  ({
    configurationAbsoluteHostPath,
    application: {
      hostPath: application.hostPath,
      configuration: application.configuration,
      pathInContainer: application.pathInContainer = application.configuration.directory.application.containerAbsolutePath || containerPath.application },


    scriptManager: { hostRelativePath: scriptManager.hostRelativePath, commandArgument: scriptManager.commandArgument = process.argv },
    invokedDirectly = false } =
  input);

  scriptManager.commandArgument = invokedDirectly ?
  scriptManager.commandArgument.slice(2) :
  scriptManager.commandArgument.slice(3),
  scriptManager.relativePathFromProject = _path.default.relative(application.hostPath, scriptManager.hostRelativePath);
  scriptManager.relativePathFromProject = (0, _slash.default)(scriptManager.relativePathFromProject);

  scriptManager.absolutePathInContainer = (0, _slash.default)(_path.default.join(application.pathInContainer, scriptManager.relativePathFromProject));

  let configurationAbsoluteContainerPath;
  {
    let relativePathFromProject = _path.default.relative(application.hostPath, configurationAbsoluteHostPath);
    relativePathFromProject = (0, _slash.default)(relativePathFromProject);
    configurationAbsoluteContainerPath = (0, _slash.default)(_path.default.join(application.pathInContainer, relativePathFromProject));
  }


  let hostWorkingDirectory_PWD = process.env.PWD,
  workingDirectoryRelativeToApp_PWD = (0, _slash.default)(_path.default.relative(application.hostPath, hostWorkingDirectory_PWD)),
  workingDirectoryInContainer_PWD = (0, _slash.default)(_path.default.join(application.pathInContainer, workingDirectoryRelativeToApp_PWD));
  let hostWorkingDirectory_CWD = process.cwd(),
  workingDirectoryRelativeToApp_CWD = (0, _slash.default)(_path.default.relative(application.hostPath, hostWorkingDirectory_CWD)),
  workingDirectoryInContainer_CWD = (0, _slash.default)(_path.default.join(application.pathInContainer, workingDirectoryRelativeToApp_CWD));

  let childProcessArray = [];
  function killChildProcess({ childProcesses = childProcessArray } = {}) {
    childProcesses.forEach((childProcess, index) => {
      childProcess.kill('SIGINT');
      childProcess.kill('SIGTERM');
      childProcesses.splice(index, 1);
    });

  }


  console.log('creating containers !!!!!');


  process.on('SIGINT', () => {

    console.log('â€¢ [NODE HOST MACHINE] Caught interrupt signal - host machine level');
    killChildProcess();
  });

  console.groupEnd();
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NvdXJjZS9ydW5JbkNvbnRhaW5lci9zY3JpcHQuanMiXSwibmFtZXMiOlsicGFyc2VkQXJnIiwicmVxdWlyZSIsImFyZ3YiLCJjb250YWluZXJQYXRoIiwiYXBwbGljYXRpb24iLCJlbnYiLCJBcnJheSIsImlzQXJyYXkiLCJleHBvcnRFbnZpcm9ubWVudEFyZyIsInJlZHVjZSIsImFjY3VtdWxhdG9yIiwiY3VycmVudFZhbHVlIiwicHJvY2VzcyIsIm1vZHVsZSIsImV4cG9ydHMiLCJydW5JbkNvbnRhaW5lciIsImlucHV0IiwiY29uc29sZSIsImxvZyIsInNjcmlwdE1hbmFnZXIiLCJpbnZva2VkRGlyZWN0bHkiLCJjb25maWd1cmF0aW9uQWJzb2x1dGVIb3N0UGF0aCIsImhvc3RQYXRoIiwiY29uZmlndXJhdGlvbiIsInBhdGhJbkNvbnRhaW5lciIsImRpcmVjdG9yeSIsImNvbnRhaW5lckFic29sdXRlUGF0aCIsImhvc3RSZWxhdGl2ZVBhdGgiLCJjb21tYW5kQXJndW1lbnQiLCJzbGljZSIsInJlbGF0aXZlUGF0aEZyb21Qcm9qZWN0IiwicGF0aCIsInJlbGF0aXZlIiwiYWJzb2x1dGVQYXRoSW5Db250YWluZXIiLCJqb2luIiwiY29uZmlndXJhdGlvbkFic29sdXRlQ29udGFpbmVyUGF0aCIsImhvc3RXb3JraW5nRGlyZWN0b3J5X1BXRCIsIlBXRCIsIndvcmtpbmdEaXJlY3RvcnlSZWxhdGl2ZVRvQXBwX1BXRCIsIndvcmtpbmdEaXJlY3RvcnlJbkNvbnRhaW5lcl9QV0QiLCJob3N0V29ya2luZ0RpcmVjdG9yeV9DV0QiLCJjd2QiLCJ3b3JraW5nRGlyZWN0b3J5UmVsYXRpdmVUb0FwcF9DV0QiLCJ3b3JraW5nRGlyZWN0b3J5SW5Db250YWluZXJfQ1dEIiwiY2hpbGRQcm9jZXNzQXJyYXkiLCJraWxsQ2hpbGRQcm9jZXNzIiwiY2hpbGRQcm9jZXNzZXMiLCJmb3JFYWNoIiwiY2hpbGRQcm9jZXNzIiwiaW5kZXgiLCJraWxsIiwi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R0FBUixDQUFZLDJCQUFaOzs7QUFHQU4sRUFBQUEsT0FBTyxDQUFDd0MsRUFBUixDQUFXLFFBQVgsRUFBcUIsTUFBTTs7QUFFekJuQyxJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxvRUFBWjtBQUNBMkIsSUFBQUEsZ0JBQWdCO0FBQ2pCLEdBSkQ7O0FBTUE1QixFQUFBQSxPQUFPLENBQUNvQyxRQUFSO0FBQ0QsQ0EvREQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzcGF3biwgc3Bhd25TeW5jIH0gZnJvbSAnY2hpbGRfcHJvY2VzcydcbmltcG9ydCBvcGVyYXRpbmdTeXN0ZW0gZnJvbSAnb3MnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IHNsYXNoIGZyb20gJ3NsYXNoJyAvLyBjb252ZXJ0IGJhY2t3YXJkIFdpbmRvd3Mgc2xhc2ggdG8gVW5peC9XaW5kb3dzIHN1cHBvcnRlZCBmb3J3YXJkIHNsYXNoLlxuaW1wb3J0IHsgc2V0SW50ZXJ2YWwgfSBmcm9tICd0aW1lcnMnXG5jb25zdCBwYXJzZWRBcmcgPSByZXF1aXJlKCd5YXJncycpLmFyZ3ZcbmltcG9ydCB7IGNvbnZlcnRPYmplY3RUb0RvY2tlckVudkZsYWcgfSBmcm9tICcuL3V0aWxpdHkvY29udmVydE9iamVjdFRvRG9ja2VyRW52RmxhZy5qcydcbmNvbnN0IGNvbnRhaW5lclBhdGggPSB7XG4gIC8vIGRlZmluZWQgcGF0aHMgb2Ygdm9sdW1lcyBpbnNpZGUgY29udGFpbmVyLlxuICBhcHBsaWNhdGlvbjogJy9wcm9qZWN0L2FwcGxpY2F0aW9uJyxcbn1cblxucGFyc2VkQXJnLmVudiA9ICFBcnJheS5pc0FycmF5KHBhcnNlZEFyZy5lbnYpID8gW3BhcnNlZEFyZy5lbnZdIDogcGFyc2VkQXJnLmVudiAvLyB0cmFuc2Zvcm0gYC0tZW52YCB2YWx1ZSBmbGFncyB0byBhcnJheSBldmVuIHdoZW4gb25seSBvbmUgdmFsdWUgcHJlc2VudFxubGV0IGV4cG9ydEVudmlyb25tZW50QXJnID0gcGFyc2VkQXJnLmVudi5yZWR1Y2UoKGFjY3VtdWxhdG9yLCBjdXJyZW50VmFsdWUpID0+IHtcbiAgaWYgKHByb2Nlc3MuZW52W2N1cnJlbnRWYWx1ZV0pXG4gICAgLy8gb25seSBrZXlzIHRoYXQgcGFzc2VkIHRocm91Z2ggZW52aXJvbm1lbnQgdmFyaWFibGVzXG4gICAgYWNjdW11bGF0b3JbY3VycmVudFZhbHVlXSA9IHByb2Nlc3MuZW52W2N1cnJlbnRWYWx1ZV1cbiAgcmV0dXJuIGFjY3VtdWxhdG9yXG59LCB7fSkgLy8gZ2V0IGVudmlyb25tZW50IHZhbHVlcyBhbmQgbWF0Y2ggdGhlbSB0byBrZXlzIGluIGFuIG9iamVjdC5cblxuLy8gTk9URTogQSB3YXkgdG8gcmVtb3ZlIGNvbW1hbmRsaW5lIGFyZ3VtZW50IGFmdGVyIHVzYWdlLlxuLy8gcHJvY2Vzcy5hcmd2ID0gcHJvY2Vzcy5hcmd2LmZpbHRlcih2YWx1ZSA9PiB2YWx1ZSAhPT0gYGNvbmZpZ3VyYXRpb249JHtuYW1lZEFyZ3MuY29uZmlndXJhdGlvbn1gKSAvLyByZW1vdmUgY29uZmlndXJhdGlvbiBwYXJhbXRlclxuXG4vKipcbiAqIFJ1bnMgc2NyaXB0TWFuYWdlciBpbiBjb250YWluZXIgd2l0aCB0aGUgdGFyZ2V0IGFwcCBhcyB2b2x1bWUuXG4gKiBTcGlucyBhIGNvbnRhaW5lciBhbmQgcGFzc2VzIGVudHJ5cG9pbnQgbm9kZSBzY3JpcHQgdGhlIHJlbGV2YW50IHBhcmFtZXRlcnMgdXNlZCBhczpcbiAqICAtIFByb2plY3Qgcm9vdCBwYXRoXG4gKiAgLSBNYW5hZ2VyIHBhdGggaW4gY29udGFpbmVyXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gcnVuSW5Db250YWluZXIoaW5wdXQpIHtcbiAgY29uc29sZS5sb2cocHJvY2Vzcy5hcmd2KVxuICAvLyB1c2UgbmVzdGVkIG9iamVjdHMgYXMgZnVuY3Rpb24gcGFyYW1ldGVycyAtIGFuIGltcGxlbWVudGF0aW9uIG9mIGRlc3RydWN0dXJpbmcgdGhhdCBwcmVzZXJ2ZXMgbmVzdGVkIHN0cnVjdHVyZSBvZiBwYXJhbWV0ZXJzIGFuZCBkZWZhdWx0IHZhbHVlcy4gLy8gSVNTVUU6IGRvZXNuJ3QgdGhyb3cgaWYgcGFyYW1ldGVycyBub3QgcGFzc2VkLlxuICBsZXQgYXBwbGljYXRpb24gPSB7fSxcbiAgICBzY3JpcHRNYW5hZ2VyID0ge30sXG4gICAgaW52b2tlZERpcmVjdGx5LFxuICAgIGNvbmZpZ3VyYXRpb25BYnNvbHV0ZUhvc3RQYXRoXG4gIDsoe1xuICAgIGNvbmZpZ3VyYXRpb25BYnNvbHV0ZUhvc3RQYXRoLFxuICAgIGFwcGxpY2F0aW9uOiB7XG4gICAgICBob3N0UGF0aDogYXBwbGljYXRpb24uaG9zdFBhdGgsIC8vIHRoZSBXaW5kb3dzIGhvc3QgYXBwbGljYXRpb24gcGF0aFxuICAgICAgY29uZmlndXJhdGlvbjogYXBwbGljYXRpb24uY29uZmlndXJhdGlvbixcbiAgICAgIHBhdGhJbkNvbnRhaW5lcjogYXBwbGljYXRpb24ucGF0aEluQ29udGFpbmVyID0gYXBwbGljYXRpb24uY29uZmlndXJhdGlvbi5kaXJlY3RvcnkuYXBwbGljYXRpb24uY29udGFpbmVyQWJzb2x1dGVQYXRoIHx8IGNvbnRhaW5lclBhdGguYXBwbGljYXRpb24sXG4gICAgfSxcbiAgICAvLyBhcyBkZWZhdWx0IHRoZSBzY3JpcHRNYW5hZ2VyIHNob3VsZCBiZSBpbnN0YWxsZWQgKGkuZS4gZXhwZWN0ZWQgdG8gYmUgYSBkZXBlbmRlbmN5KSBhcyBhIGRlcGVuZGVuY3kgaW4gYSBuZXN0ZWQgZm9sZGVyIHRvIHRoZSBhcHBsaWNhdGlvbi5cbiAgICBzY3JpcHRNYW5hZ2VyOiB7IGhvc3RSZWxhdGl2ZVBhdGg6IHNjcmlwdE1hbmFnZXIuaG9zdFJlbGF0aXZlUGF0aCwgY29tbWFuZEFyZ3VtZW50OiBzY3JpcHRNYW5hZ2VyLmNvbW1hbmRBcmd1bWVudCA9IHByb2Nlc3MuYXJndiB9LFxuICAgIGludm9rZWREaXJlY3RseSA9IGZhbHNlLFxuICB9ID0gaW5wdXQpIC8vIGRlc3RydWN0dXJlIG5lc3RlZCBvYmplY3RzIHRvIHRoZSBvYmplY3QgcHJvcGVydGllcyB0aGVtc2VsdmVzLlxuXG4gIDsoc2NyaXB0TWFuYWdlci5jb21tYW5kQXJndW1lbnQgPSBpbnZva2VkRGlyZWN0bHlcbiAgICA/IHNjcmlwdE1hbmFnZXIuY29tbWFuZEFyZ3VtZW50LnNsaWNlKDIpIC8vIHJlbW92ZSBmaXJzdCAyIGNvbW1hbmRzIG9ubHkgLSBcIjxiaW5QYXRoPi9ub2RlXCIsIFwiPHBhdGg+L2NvbnRhaW5lck1hbmFnZXIuanNcIi5cbiAgICA6IHNjcmlwdE1hbmFnZXIuY29tbWFuZEFyZ3VtZW50LnNsaWNlKDMpKSwgLy8gcmVtb3ZlIGZpcnN0IDIgY29tbWFuZHMgLSBcIjxiaW5QYXRoPi9ub2RlXCIsIFwiPHBhdGg+L2VudHJ5cG9pbnQuanNcIiBhbmQgdGhlIHRoaXJkIGhvc3QgbWFjaGluZSBzY3JpcHQgbmFtZSBcImNvbnRhaW5lck1hbmFnZXJcIlxuICAgIChzY3JpcHRNYW5hZ2VyLnJlbGF0aXZlUGF0aEZyb21Qcm9qZWN0ID0gcGF0aC5yZWxhdGl2ZShhcHBsaWNhdGlvbi5ob3N0UGF0aCwgc2NyaXB0TWFuYWdlci5ob3N0UmVsYXRpdmVQYXRoKSlcbiAgc2NyaXB0TWFuYWdlci5yZWxhdGl2ZVBhdGhGcm9tUHJvamVjdCA9IHNsYXNoKHNjcmlwdE1hbmFnZXIucmVsYXRpdmVQYXRoRnJvbVByb2plY3QpIC8vIGNvbnZlcnQgdG8gVW5peCBwYXRoIGZyb20gV2luZG93cyBwYXRoIChjaGFuZ2UgXFwgc2xhc2ggdG8gLylcbiAgLy8gTk9URTogY3JlYXRpbmcgYW4gYWJzb2x1dGUgcGF0aCBmb3Igc2NyaXB0TWFuYWdlciBhc3N1bWVzIHRoYXQgdGhlIG1vZHVsZSBleGlzdCB1bmRlciB0aGUgYXBwbGljYXRpb24gZGlyZWN0b3J5ICgvcHJvamVjdC9hcHBsaWNhdGlvbikuXG4gIHNjcmlwdE1hbmFnZXIuYWJzb2x1dGVQYXRoSW5Db250YWluZXIgPSBzbGFzaChwYXRoLmpvaW4oYXBwbGljYXRpb24ucGF0aEluQ29udGFpbmVyLCBzY3JpcHRNYW5hZ2VyLnJlbGF0aXZlUGF0aEZyb21Qcm9qZWN0KSkgLy8gY3JlYXRlIGFuIGFic29sdXRlIHBhdGggZm9yIHNjcmlwdE1hbmFnZXIgd2hpY2ggc2hvdWxkIGJlIG5lc3RlZCB0byBhcHBsaWNhdGlvbiBwYXRoLlxuXG4gIGxldCBjb25maWd1cmF0aW9uQWJzb2x1dGVDb250YWluZXJQYXRoXG4gIHtcbiAgICBsZXQgcmVsYXRpdmVQYXRoRnJvbVByb2plY3QgPSBwYXRoLnJlbGF0aXZlKGFwcGxpY2F0aW9uLmhvc3RQYXRoLCBjb25maWd1cmF0aW9uQWJzb2x1dGVIb3N0UGF0aClcbiAgICByZWxhdGl2ZVBhdGhGcm9tUHJvamVjdCA9IHNsYXNoKHJlbGF0aXZlUGF0aEZyb21Qcm9qZWN0KSAvLyBjb252ZXJ0IHRvIFVuaXggcGF0aCBmcm9tIFdpbmRvd3MgcGF0aCAoY2hhbmdlIFxcIHNsYXNoIHRvIC8pXG4gICAgY29uZmlndXJhdGlvbkFic29sdXRlQ29udGFpbmVyUGF0aCA9IHNsYXNoKHBhdGguam9pbihhcHBsaWNhdGlvbi5wYXRoSW5Db250YWluZXIsIHJlbGF0aXZlUGF0aEZyb21Qcm9qZWN0KSkgLy8gY3JlYXRlIGFuIGFic29sdXRlIHBhdGggd2hpY2ggc2hvdWxkIGJlIG5lc3RlZCB0byBhcHBsaWNhdGlvbiBwYXRoLlxuICB9XG5cbiAgLy8gcmVzb2x2ZSB3b3JraW5nIGRpcmVjdG9yeSBwYXRoIGZyb20gaG9zdCBwYXRoIHRvIGNvbnRhaW5lciBwYXRoLlxuICBsZXQgaG9zdFdvcmtpbmdEaXJlY3RvcnlfUFdEID0gcHJvY2Vzcy5lbnYuUFdELFxuICAgIHdvcmtpbmdEaXJlY3RvcnlSZWxhdGl2ZVRvQXBwX1BXRCA9IHNsYXNoKHBhdGgucmVsYXRpdmUoYXBwbGljYXRpb24uaG9zdFBhdGgsIGhvc3RXb3JraW5nRGlyZWN0b3J5X1BXRCkpLFxuICAgIHdvcmtpbmdEaXJlY3RvcnlJbkNvbnRhaW5lcl9QV0QgPSBzbGFzaChwYXRoLmpvaW4oYXBwbGljYXRpb24ucGF0aEluQ29udGFpbmVyLCB3b3JraW5nRGlyZWN0b3J5UmVsYXRpdmVUb0FwcF9QV0QpKSAvLyBhYnNvbHV0ZSBjb250YWluZXIgcGF0aCBvZiB3b3JraW5nIGRpcmVjdG9yeVxuICBsZXQgaG9zdFdvcmtpbmdEaXJlY3RvcnlfQ1dEID0gcHJvY2Vzcy5jd2QoKSxcbiAgICB3b3JraW5nRGlyZWN0b3J5UmVsYXRpdmVUb0FwcF9DV0QgPSBzbGFzaChwYXRoLnJlbGF0aXZlKGFwcGxpY2F0aW9uLmhvc3RQYXRoLCBob3N0V29ya2luZ0RpcmVjdG9yeV9DV0QpKSxcbiAgICB3b3JraW5nRGlyZWN0b3J5SW5Db250YWluZXJfQ1dEID0gc2xhc2gocGF0aC5qb2luKGFwcGxpY2F0aW9uLnBhdGhJbkNvbnRhaW5lciwgd29ya2luZ0RpcmVjdG9yeVJlbGF0aXZlVG9BcHBfQ1dEKSkgLy8gYWJzb2x1dGUgY29udGFpbmVyIHBhdGggb2Ygd29ya2luZyBkaXJlY3RvcnlcblxuICBsZXQgY2hpbGRQcm9jZXNzQXJyYXkgPSBbXVxuICBmdW5jdGlvbiBraWxsQ2hpbGRQcm9jZXNzKHsgY2hpbGRQcm9jZXNzZXMgPSBjaGlsZFByb2Nlc3NBcnJheSB9ID0ge30pIHtcbiAgICBjaGlsZFByb2Nlc3Nlcy5mb3JFYWNoKChjaGlsZFByb2Nlc3MsIGluZGV4KSA9PiB7XG4gICAgICBjaGlsZFByb2Nlc3Mua2lsbCgnU0lHSU5UJylcbiAgICAgIGNoaWxkUHJvY2Vzcy5raWxsKCdTSUdURVJNJylcbiAgICAgIGNoaWxkUHJvY2Vzc2VzLnNwbGljZShpbmRleCwgMSkgLy8gcmVtb3ZlIGl0ZW0gZnJvbSBhcnJheVxuICAgIH0pXG4gICAgLy8gcHJvY2Vzcy5leGl0KClcbiAgfVxuXG4gIC8vIGNyZWF0ZSBjb250YWluZXJcbiAgY29uc29sZS5sb2coJ2NyZWF0aW5nIGNvbnRhaW5lcnMgISEhISEnKVxuICAvLyBUT0RPOiBBZGQgcmVxdWlyZSBzdGF0ZW1lbnRzIGZyb20gZGlyZWN0b3J5IGAuL2NvbnRhaW5lclNjcmlwdGBcblxuICBwcm9jZXNzLm9uKCdTSUdJTlQnLCAoKSA9PiB7XG4gICAgLy8gd2hlbiBkb2NrZXIgaXMgdXNpbmcgYC1pdGAgb3B0aW9uIHRoaXMgZXZlbnQgd29uJ3QgYmUgZmlyZWQgaW4gdGhpcyBwcm9jZXNzLCBhcyB0aGUgU0lHSU5UIHNpZ25hbCBpcyBwYXNzZWQgZGlyZWN0bHkgdG8gdGhlIGRvY2tlciBjb250YWluZXIuXG4gICAgY29uc29sZS5sb2coJ+KAoiBbTk9ERSBIT1NUIE1BQ0hJTkVdIENhdWdodCBpbnRlcnJ1cHQgc2lnbmFsIC0gaG9zdCBtYWNoaW5lIGxldmVsJylcbiAgICBraWxsQ2hpbGRQcm9jZXNzKClcbiAgfSlcblxuICBjb25zb2xlLmdyb3VwRW5kKClcbn1cbiJdfQ==